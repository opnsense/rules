# This file contains rules matching known malware JA3 signatures.
# Most of them are not intensivly tested and might produce FPs!

############################################################
# Rule extraction from malware-traffic-analysis.net 01/2018:
############################################################

# Hits from:
# 2018-01-02-fake-Flash-player-installs-coinminer-malware.pcap
# 2018-01-02-whatsapp-malspam-traffic.pcap
# 2018-01-06-fake-AV-page-after-viewing-mitchandgina.com.pcap
# 2018-01-09-Emotet-and-Zeus-Panda-Banker-traffic.pcap
# and many more ...
#alert tls any any -> any any (msg:"OPNsense: match JA3 malware hash, rule 1"; ja3_hash; content:"4d7a28d6f2263ed61de88ca66eb011e3"; classtype:ja3-malware; sid:49000001; rev:1;)

# Hits from:
# 2018-01-03-malspam-infection-traffic.pcap
#alert tls any any -> any any (msg:"OPNsense: match JA3 malware hash, rule 2"; ja3_hash; content:"6734f37431670b3ab4292b8f60f29984"; classtype:ja3-malware; sid:49000002; rev:1;)

# Hits from:
# 2018-01-25-Dridex-malspam-infection-traffic-1-of-2.pcap
#alert tls any any -> any any (msg:"OPNsense: match JA3 malware hash, rule 3"; ja3_hash; content:"74927e242d6c3febf8cb9cab10a7f889"; classtype:ja3-malware; sid:49000003; rev:1;)

# Hits from:
# 2018-01-25-Dridex-malspam-infection-traffic-2-of-2.pcap
#alert tls any any -> any any (msg:"OPNsense: match JA3 malware hash, rule 4"; ja3_hash; content:"67f762b0ffe3aad00dfdb0e4b1acd8b5"; classtype:ja3-malware; sid:49000004; rev:1;)

############################################################
# Rule extraction from malware-traffic-analysis.net 02/2018:
############################################################

# Hits from:
# 2018-02-08-malspam-pushing-Quant-Loader-2nd-run.pcap
#alert tls any any -> any any (msg:"OPNsense: match JA3 malware hash, rule 5"; ja3_hash; content:"10ee8d30a5d01c042afd7b2b205facc4"; classtype:ja3-malware; sid:49000005; rev:1;)

# Hits from:
# 2018-02-28-Hancitor-infection-traffic-3rd-run.pcap
#alert tls any any -> any any (msg:"OPNsense: match JA3 malware hash, rule 6"; ja3_hash; content:"ada70206e40642a3e4461f35503241d5"; classtype:ja3-malware; sid:49000006; rev:1;)

############################################################
# Rule extraction from malware-traffic-analysis.net 03/2018:
############################################################

# Hits from:
# 2018-03-05-CoinsLTD-campaign-Rig-EK-and-post-infection-traffic.pcap
#alert tls any any -> any any (msg:"OPNsense: match JA3 malware hash, rule 7"; ja3_hash; content:"c201b92f8b483fa388be174d6689f534"; classtype:ja3-malware; sid:49000007; rev:1;)

# Hits from:
# 2018-03-08-Hookads-campaign-Rig-EK.pcap
#alert tls any any -> any any (msg:"OPNsense: match JA3 malware hash, rule 8; ja3_hash; content:"d4693422c5ce1565377aca25940ad80c"; classtype:ja3-malware; sid:49000008; rev:1;)
#alert tls any any -> any any (msg:"OPNsense: match JA3 malware hash, rule 9"; ja3_hash; content:"40fd0a5e81ebdcf0ec82a4710a12dec1"; classtype:ja3-malware; sid:49000009; rev:1;)
#alert tls any any -> any any (msg:"OPNsense: match JA3 malware hash, rule 10"; ja3_hash; content:"1e67431b78a64adf42e0fee804fb15e5"; classtype:ja3-malware; sid:49000010; rev:1;)
#alert tls any any -> any any (msg:"OPNsense: match JA3 malware hash, rule 11"; ja3_hash; content:"db6b2a19e5cd3b42abbc21f13c3fc750"; classtype:ja3-malware; sid:49000011; rev:1;)
#alert tls any any -> any any (msg:"OPNsense: match JA3 malware hash, rule 12"; ja3_hash; content:"29085f03f8e8a03f0b399c5c7cf0b0b8"; classtype:ja3-malware; sid:49000012; rev:1;)
#alert tls any any -> any any (msg:"OPNsense: match JA3 malware hash, rule 13"; ja3_hash; content:"d3b972883dfbd24fd20fc200ad8ab22a"; classtype:ja3-malware; sid:49000013; rev:1;)
#alert tls any any -> any any (msg:"OPNsense: match JA3 malware hash, rule 14"; ja3_hash; content:"46efd49abcca8ea9baa932da68fdb529"; classtype:ja3-malware; sid:49000014; rev:1;)
#alert tls any any -> any any (msg:"OPNsense: match JA3 malware hash, rule 15"; ja3_hash; content:"5d62f64398e43b0a4ea9d15167f3a01d"; classtype:ja3-malware; sid:49000015; rev:1;)

# Hits from:
# 2018-03-22-fake-firefox-update.pcap
#alert tls any any -> any any (msg:"OPNsense: match JA3 malware hash, rule 16"; ja3_hash; content:"0ffee3ba8e615ad22535e7f771690a28"; classtype:ja3-malware; sid:49000016; rev:1;)

# Hits from:
# 2018-03-26-Sigma-ransomware-malspam-infection-traffic.pcap
#alert tls any any -> any any (msg:"OPNsense: match JA3 malware hash, rule 17"; ja3_hash; content:"fed8d14fc5a67b40cd470ba239019785"; classtype:ja3-malware; sid:49000017; rev:1;)
#alert tls any any -> any any (msg:"OPNsense: match JA3 malware hash, rule 18"; ja3_hash; content:"83d60721ecc423892660e275acc4dffd"; classtype:ja3-malware; sid:49000018; rev:1;)

# Hits from:
# 2018-03-27-fake-chrome-update.pcap
#alert tls any any -> any any (msg:"OPNsense: match JA3 malware hash, rule 19"; ja3_hash; content:"14eff09463c9d6dc6e14e954eba239c2"; classtype:ja3-malware; sid:49000019; rev:1;)
#alert tls any any -> any any (msg:"OPNsense: match JA3 malware hash, rule 20"; ja3_hash; content:"656854b0e07f676ae44f8d559744be60"; classtype:ja3-malware; sid:49000020; rev:1;)
